{% extends "base/layout-summary.html" %}


{% block content %}
<div class="container">
    <div class="row">
        <div class="span12">

            <h3>Flow Details</h3>

            <table class="table">
                <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>

                <tr>
                    <td>File Name</td>
                    <td><a href="/uploads/{{ flow.get_upload_path }}/{{ flow.file_name }}">{{ flow.file_name }}</a></td>
                </tr>

                <tr>
                    <td>Upload Time</td>
                    <td>{{ flow.upload_time|date:"r" }}</td>
                </tr>

                <tr>
                    <td>MD5</td>
                    <td>{{ flow.hash_value }}</td>
                </tr>

                <tr>
                    <td>File Type</td>
                    <td>{{ flow.file_type }}</td>
                </tr>

                <tr>
                    <td>File Size</td>
                    <td>{{ flow.file_size|filesizeformat }}</td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>

    <div class="row">

        <div class="span12">
            <h3>Flow Pcaps Created</h3>
            <table class="table">
                <thead>
                <tr>
                    <th>Pcap File Name</th>
                <tr>
                </thead>
                <tbody>

                <tr>
                    <td>
                        <select name="select_pcap_file_{{ flow.pcaps.0.id }}" id="select_pcap_file_{{ flow.pcaps.0.id }}" onchange="update_link('select_pcap_file_{{ flow.pcaps.0.id }}')">
                            {% for pcap in flow.pcaps %}
                            <option value="{{ pcap.id }}">{{ pcap.file_name }}</option>
                            {% endfor %}
                        </select>
                        <div id="pcap_file_link_{{ flow.pcaps.0.id }}" name="pcap_file_link_{{ flow.pcaps.0.id }}">
                            <a href="/uploads/{{ flow.pcaps.0.get_upload_path }}/{{ flow.pcaps.0.file_name }}">{{ flow.pcaps.0.file_name }}</a>
                        </div>
                    </td>
                </tr>

                </tbody>
            </table>
        </div>

    </div>

    <div class="row">
        <div class="span12">
            <ul class="nav nav-tabs">
                <li class="active">
                    <a href="#">Overview</a>
                </li>
                <li>
                    <a href="{% url file_pcap_summary hash_value %}">Summary</a>
                </li>
                <li>
                    <a href="#">Visualize</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="span8">
            <div id="chart">
                <svg style="height:500px"></svg>
            </div>
        </div>

        <div class="span4">
            {% block right %}


            <table class="table">
                <thead>
                <tr>
                    <th>Protocol</th>
                    <th>Details</th>
                </tr>
                </thead>
                <tbody>
                {% for json in json_response %}
                <tr>
                    <td><a href="{% url file_protocol_summary hash_value json.key json.values.0.x %}">{{ json.key }}</a></td>

                    <td>

                        <table class="table table-condensed">
                            <thead>
                            <tr>
                                <th>Date</th>
                                <th>Count</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for detail in json.values %}
                            <tr>
                                <td>{{ detail.x }}</td>
                                <td>{{ detail.y }}</td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>

                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>

            {% endblock %}
        </div>

    </div>

</div>
{% endblock %}
