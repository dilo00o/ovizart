<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{% if page_title %}{{ page_title }}{% else %}No page title set. Bug a developer!{% endif %}</title>
    <link rel="icon" href="{{ MEDIA_URL }}images/favicon.ico" type="image/x-icon">

    <meta name="description" content="Network Analyzer for your pcap files">
    <meta name="author" content="Oğuz Yarımtepe">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/site_media/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/site_media/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/site_media/bootstrap/css/docs.css" rel="stylesheet">

    <style>
        body {
            padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
        }
    </style>

    <!-- settings for jquery timeline widget-->
    {% ifequal pcap_operation "summary" %}
    <link rel="stylesheet" href="/site_media/jquery_widget/css/aristo/jquery-ui-1.8.5.custom.css" type="text/css"
          media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="/site_media/jquery_widget/js/timeglider/Timeglider.css" type="text/css"
          media="screen" title="no title" charset="utf-8">



    <style type='text/css'>

        body {
            font-family: Helvetica, Arial, sans-serif;
        }

        #summary_info {
            margin:32px;
            margin-bottom:0;
            height:500px;
        }

        #output {
            font-size:10px;
        }

        .shadow-years .timeglider-event-title {
            color:#F0F0F0;
        }
        .shadow-years .timeglider-event-spanner {
            background-color:#4C5408;
        }

        .bibliocene .timeglider-event-title {
            color:#F0F0F0;
        }
        .bibliocene .timeglider-event-spanner {
            background-color:orange;
        }

        .js-era .timeglider-event-title {
            color:#323230;
        }
        .js-era .timeglider-event-spanner {
            background-color:#f0db4e;
        }

        .hawt .timeglider-event-title {
            color:white;
        }
        .hawt .timeglider-event-spanner {
            background-color:#CC106B;
        }

        .browserwars .timeglider-event-title {
            color:black;
        }
        .browserwars .timeglider-event-spanner {
            background-color:#CC0000;
        }

        .inception .timeglider-event-title {
            color:green;
        }
        .inception .timeglider-event-spanner {
            background-color:white;
        }

        .tg-timeline-envelope .titleBar {
            opacity:.2;
        }

    </style>

    {% endifequal %}

    {% ifequal pcap_operation "summary-size" %}
    <script src="/site_media/d3/js/d3.v2.js"></script>
    <link rel="stylesheet" href="/site_media/d3/css/treemap.css" type="text/css"
          media="screen" title="no title" charset="utf-8">
    {% endifequal %}

    {% ifequal pcap_operation "welcome" %}
    <link href="/site_media/nvd3/src/d3.css" rel="stylesheet" type="text/css">
    <script src="/site_media/nvd3/lib/d3.v2.js"></script>
    <script src="/site_media/nvd3/lib/fisheye.js"></script>
    <script src="/site_media/nvd3/nv.d3.js"></script>
    <script src="/site_media/nvd3/src/tooltip.js"></script>
    <script src="/site_media/nvd3/src/models/legend.js"></script>
    <script src="/site_media/nvd3/src/models/axis.js"></script>
    <script src="/site_media/nvd3/src/models/distribution.js"></script>
    <script src="/site_media/nvd3/src/models/scatter.js"></script>
    <script src="/site_media/nvd3/src/models/scatterChart.js"></script>
    {% endifequal %}

</head>

<body>
{% block navigation %}  {% endblock %}

{% block content %} {% endblock %}

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="/site_media/bootstrap/js/bootstrap.js" type="text/javascript"></script>

<!-- js files for pcap summary -->
{% ifequal pcap_operation "summary" %}
<script src="/site_media/jquery_widget/js/jquery-ui.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/underscore-min.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/backbone-min.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/jquery.tmpl.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/ba-debug.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/ba-tinyPubSub.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/jquery.mousewheel.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/jquery.ui.ipad.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/jquery.global.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/TG_Date.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/TG_Org.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/TG_Timeline.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/TG_TimelineView.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/TG_Mediator.js" type="text/javascript" charset="utf-8"></script>
<script src="/site_media/jquery_widget/js/timeglider/timeglider.timeline.widget.js" type="text/javascript"></script>

<script type='text/javascript'>

    $(function () {
        var tg_actor = {};

        var tg1 = $("#summary_info").timeline({
            "timezone":"+03:00",
            "min_zoom":1,
            "max_zoom":100,
            "show_centerline":true,
            "data_source":"{{ json_file_url }}",
            "show_footer":false,
            "display_zoom_level":true,
            "icon_folder": "{{ icon_folder }}"
        }).resizable({
                    stop:function(){
                        $(this).data("timeline").resize();
                    }
                });

        tg_actor = tg1.data("timeline");

        timeglider.methods = {
            zoomIn:function() { tg_actor.zoom("in"); }
        };

        // test to bring up filter by default, on load
        setTimeout(function() {
            $(".tg-timeline-legend-bt").trigger("click");
        }, 2000);

        $("#tags-button").bind("click", function() {
            var txt = $("#tags-input").val();
            tg_actor.filterBy("tags", txt);
        });

    }); // end document-ready

</script>


{% endifequal %}

{% ifequal pcap_operation "summary-size" %}
<script type='text/javascript'>
var width = 960,
    height = 500,
    color = d3.scale.category20c();

var treemap = d3.layout.treemap()
    .size([width, height])
    .sticky(true)
    .value(function(d) { return d.size; });

var div = d3.select("#summary_size_info").append("div")
    .style("position", "relative")
    .style("width", width + "px")
    .style("height", height + "px");

d3.json("{{ json_file_url }}", function(json) {
div.data([json]).selectAll("div")
.data(treemap.nodes)
.enter().append("div")
.attr("class", "cell")
.style("background", function(d) { return d.children ? color(d.name) : null; })
.call(cell)
.text(function(d) { return d.children ? null : d.name; });
});

function cell() {
  this
      .style("left", function(d) { return d.x + "px"; })
      .style("top", function(d) { return d.y + "px"; })
      .style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
      .style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
}
</script>
{% endifequal %}

{% ifequal pcap_operation "welcome" %}
<script>


    var g_data = [];



    //Format A
//    nv.addGraph(function() {
//        var chart = nv.models.scatterChart()
//                .showDistX(true)
//                .showDistY(true)
//            //.height(500)
//                .color(d3.scale.category10().range());
//
//        chart.xAxis.tickFormat(d3.format('.02f'))
//        chart.yAxis.tickFormat(d3.format('.02f'))
//
//        d3.select('#chart svg')
//                .datum(getData())
//                .transition().duration(500)
//                .call(chart);
//
//        nv.utils.windowResize(chart.update);
//
//        return chart;
//    });


    //function getData() {

        d3.json('{{ json_file_url }}', function(jsondata) {
            console.log("jsondata");
            console.log(jsondata);
            //alert(JSON.stringify(data));
            nv.addGraph(function() {
                var chart = nv.models.scatterChart()
                        .showDistX(true)
                        .showDistY(true)
                    //.height(500)
                        .color(d3.scale.category10().range());

                //chart.xAxis.tickFormat(d3.format('.02f'))
                //chart.yAxis.tickFormat(d3.format('.02f'))
                chart.xAxis.tickFormat(d3.format('r'))
                chart.yAxis.tickFormat(d3.format('r'))

                //labeling
                chart.xAxis.axisLabel('Year')
                chart.yAxis.axisLabel('Number of Packets')

                d3.select('#chart svg')
                        .datum(jsondata)
                        .transition().duration(500)
                        .call(chart);

                nv.utils.windowResize(chart.update);

                return chart;
            });

            console.log("chart is added");

        });

    //    console.log("data is set")
    //    console.log(g_data);
    //    return g_data;
    //}

    function randomData(groups, points) { //# groups,# points per group
        var data = [],
                shapes = ['circle', 'cross', 'triangle-up', 'triangle-down', 'diamond', 'square'],
                random = d3.random.normal();

        for (i = 0; i < groups; i++) {
            data.push({
                key: 'Group ' + i,
                values: []
            });

            for (j = 0; j < points; j++) {
                data[i].values.push({
                    x: random(),
                    y: random(),
                    size: Math.random(),
                    shape: shapes[j % 6]
                });
            }
        }

        //alert(JSON.stringify(data));
        return data;
    }



</script>
{% endifequal %}

</body>
</html>